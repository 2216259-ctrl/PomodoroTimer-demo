<!DOCTYPE html>
<html class="dark" lang="ko">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta name="description" content="TDDì™€ SOLID ì›ì¹™ì„ ì¤€ìˆ˜í•œ í˜„ëŒ€ì ì¸ ë½€ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜" />
    <meta name="theme-color" content="#13c8ec" />
    <title>Pomodoro Timer - ìƒì‚°ì„± í–¥ìƒ ë„êµ¬</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet" />

    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#13c8ec",
                        "background-light": "#f6f8f8",
                        "background-dark": "#101f22",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>

    <style>
        /* Custom styles for circular progress */
        .progress-ring__circle {
            transition: stroke-dashoffset 0.35s;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display min-h-screen flex flex-col items-center justify-center overflow-hidden selection:bg-primary/30">
    <div
        class="relative w-full max-w-md h-screen max-h-[900px] flex flex-col justify-between bg-white dark:bg-[#101f22] sm:border-x dark:sm:border-[#223032] sm:shadow-xl">

        <!-- Header -->
        <header class="flex items-center justify-between p-6 z-10">
            <button
                class="text-slate-600 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors p-2 rounded-full hover:bg-slate-100 dark:hover:bg-white/5"
                aria-label="ì„¤ì •">
                <span class="material-symbols-outlined">settings</span>
            </button>

            <div id="focusMode" class="flex items-center gap-2 px-3 py-1 bg-slate-100 dark:bg-white/5 rounded-full">
                <span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span>
                <span class="text-sm font-semibold text-slate-700 dark:text-slate-300 tracking-wide uppercase">Focus
                    Mode</span>
            </div>

            <button
                class="text-slate-600 dark:text-slate-400 hover:text-primary dark:hover:text-primary transition-colors p-2 rounded-full hover:bg-slate-100 dark:hover:bg-white/5"
                aria-label="í†µê³„">
                <span class="material-symbols-outlined">bar_chart</span>
            </button>
        </header>

        <!-- Main Timer Content -->
        <main class="flex-1 flex flex-col items-center justify-center relative px-6 w-full">
            <!-- Circular Progress Container -->
            <div class="relative w-72 h-72 sm:w-80 sm:h-80 flex items-center justify-center">
                <!-- Background Circle -->
                <svg class="w-full h-full transform" viewBox="0 0 100 100">
                    <circle class="text-slate-200 dark:text-[#1a2c30]" cx="50" cy="50" fill="transparent" r="46"
                        stroke="currentColor" stroke-width="4"></circle>
                    <!-- Progress Circle -->
                    <circle id="progressCircle"
                        class="text-primary progress-ring__circle drop-shadow-[0_0_10px_rgba(19,200,236,0.5)]" cx="50"
                        cy="50" fill="transparent" r="46" stroke="currentColor" stroke-dasharray="289.026"
                        stroke-dashoffset="0" stroke-linecap="round" stroke-width="4"></circle>
                </svg>

                <!-- Timer Text Overlay -->
                <div class="absolute inset-0 flex flex-col items-center justify-center z-10">
                    <h1 id="timerDisplay"
                        class="text-7xl sm:text-8xl font-black text-slate-900 dark:text-white tracking-tighter tabular-nums leading-none mb-2">
                        50:00
                    </h1>
                    <p id="endTime"
                        class="text-slate-400 dark:text-slate-500 font-medium text-lg flex items-center gap-1">
                        <span class="material-symbols-outlined text-[18px]">notifications_active</span>
                        <span id="endTimeText">--:--</span>
                    </p>
                </div>
            </div>

            <!-- Context Info -->
            <div class="mt-12 text-center space-y-2">
                <h2 id="sessionTitle" class="text-slate-800 dark:text-white text-xl font-bold">ì§‘ì¤‘ ì‹œê°„</h2>
                <p id="sessionDesc"
                    class="text-slate-500 dark:text-slate-400 text-sm max-w-[200px] mx-auto leading-relaxed">
                    50ë¶„ ë™ì•ˆ í•œ ê°€ì§€ ëª©í‘œì— ì§‘ì¤‘í•˜ì„¸ìš”.
                </p>
            </div>

            <!-- Rounds Indicator -->
            <div class="mt-8 flex gap-2" role="status" aria-label="í˜„ì¬ ë¼ìš´ë“œ: 1/4">
                <div id="round1" class="w-2 h-2 rounded-full bg-primary"></div>
                <div id="round2" class="w-2 h-2 rounded-full bg-slate-300 dark:bg-slate-700"></div>
                <div id="round3" class="w-2 h-2 rounded-full bg-slate-300 dark:bg-slate-700"></div>
                <div id="round4" class="w-2 h-2 rounded-full bg-slate-300 dark:bg-slate-700"></div>
            </div>
        </main>

        <!-- Bottom Controls -->
        <footer class="p-8 pb-10 w-full">
            <div class="flex items-center justify-center gap-6">
                <!-- Reset Button -->
                <button id="resetBtn"
                    class="group flex items-center justify-center w-14 h-14 rounded-full bg-slate-100 dark:bg-white/10 hover:bg-slate-200 dark:hover:bg-white/20 transition-all text-slate-600 dark:text-white"
                    aria-label="ì´ˆê¸°í™”">
                    <span
                        class="material-symbols-outlined group-hover:-rotate-90 transition-transform duration-500">replay</span>
                </button>

                <!-- Play/Pause Button -->
                <button id="playPauseBtn"
                    class="relative group flex items-center justify-center w-24 h-24 rounded-full bg-primary hover:bg-[#11b5d6] transition-all shadow-lg shadow-primary/30 active:scale-95"
                    aria-label="ì‹œì‘">
                    <span id="playPauseIcon"
                        class="material-symbols-outlined text-black dark:text-[#101f22] text-5xl fill-1 ml-1 group-hover:scale-110 transition-transform">play_arrow</span>
                    <!-- Ripple effect decorative ring -->
                    <span
                        class="absolute inset-0 rounded-full border border-primary/50 scale-110 animate-ping opacity-20"></span>
                </button>

                <!-- Skip/Next Button -->
                <button id="skipBtn"
                    class="group flex items-center justify-center w-14 h-14 rounded-full bg-slate-100 dark:bg-white/10 hover:bg-slate-200 dark:hover:bg-white/20 transition-all text-slate-600 dark:text-white"
                    aria-label="ë‹¤ìŒ">
                    <span
                        class="material-symbols-outlined group-hover:translate-x-1 transition-transform">skip_next</span>
                </button>
            </div>
        </footer>

        <!-- Background Decor -->
        <div
            class="absolute top-0 left-0 w-full h-64 bg-gradient-to-b from-primary/5 to-transparent pointer-events-none">
        </div>
    </div>

    <!-- Footer Info -->
    <div
        class="fixed bottom-4 left-1/2 transform -translate-x-1/2 text-center text-xs text-slate-500 dark:text-slate-600">
        <p>Made with â¤ï¸ using TDD & SOLID Principles</p>
        <p class="mt-1">
            <a href="https://github.com/2216259-ctrl/PomodoroTimer-demo" target="_blank" rel="noopener noreferrer"
                class="hover:text-primary transition-colors">
                View on GitHub
            </a>
        </p>
    </div>

    <script>
        // íƒ€ì´ë¨¸ ìƒíƒœ
        let timeLeft = 50 * 60; // 50ë¶„ (ì´ˆ ë‹¨ìœ„)
        let totalTime = 50 * 60;
        let isRunning = false;
        let intervalId = null;
        let currentRound = 1;
        let sessionType = 'focus'; // 'focus', 'shortBreak', 'longBreak'

        // DOM ìš”ì†Œ
        const timerDisplay = document.getElementById('timerDisplay');
        const endTimeText = document.getElementById('endTimeText');
        const progressCircle = document.getElementById('progressCircle');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playPauseIcon = document.getElementById('playPauseIcon');
        const resetBtn = document.getElementById('resetBtn');
        const skipBtn = document.getElementById('skipBtn');
        const sessionTitle = document.getElementById('sessionTitle');
        const sessionDesc = document.getElementById('sessionDesc');

        // ì‹œê°„ í¬ë§·íŒ…
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // ì¢…ë£Œ ì‹œê°„ ê³„ì‚°
        function calculateEndTime() {
            const now = new Date();
            const end = new Date(now.getTime() + timeLeft * 1000);
            return `${end.getHours().toString().padStart(2, '0')}:${end.getMinutes().toString().padStart(2, '0')}`;
        }

        // í”„ë¡œê·¸ë ˆìŠ¤ ì—…ë°ì´íŠ¸
        function updateProgress() {
            const progress = (timeLeft / totalTime) * 100;
            const circumference = 289.026;
            const offset = circumference - (progress / 100) * circumference;
            progressCircle.style.strokeDashoffset = offset;
        }

        // ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            timerDisplay.textContent = formatTime(timeLeft);
            if (isRunning) {
                endTimeText.textContent = calculateEndTime();
            } else {
                endTimeText.textContent = '--:--';
            }
            updateProgress();
        }

        // íƒ€ì´ë¨¸ í‹±
        function tick() {
            if (timeLeft > 0) {
                timeLeft--;
                updateDisplay();
            } else {
                // íƒ€ì´ë¨¸ ì™„ë£Œ
                complete();
            }
        }

        // ì‹œì‘/ì¼ì‹œì •ì§€
        function toggleTimer() {
            if (isRunning) {
                // ì¼ì‹œì •ì§€
                pause();
            } else {
                // ì‹œì‘
                start();
            }
        }

        function start() {
            isRunning = true;
            playPauseIcon.textContent = 'pause';
            playPauseIcon.classList.remove('ml-1');
            intervalId = setInterval(tick, 1000);
            updateDisplay();

            // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
            if (Notification.permission === 'default') {
                Notification.requestPermission();
            }
        }

        function pause() {
            isRunning = false;
            playPauseIcon.textContent = 'play_arrow';
            playPauseIcon.classList.add('ml-1');
            clearInterval(intervalId);
            updateDisplay();
        }

        function reset() {
            pause();
            timeLeft = totalTime;
            updateDisplay();
        }

        function complete() {
            pause();

            // ì•Œë¦¼ í‘œì‹œ
            if (Notification.permission === 'granted') {
                new Notification('ë½€ëª¨ë„ë¡œ ì™„ë£Œ! ğŸ…', {
                    body: sessionType === 'focus' ? 'íœ´ì‹ ì‹œê°„ì…ë‹ˆë‹¤!' : 'ë‹¤ì‹œ ì§‘ì¤‘í•  ì‹œê°„ì…ë‹ˆë‹¤!',
                    icon: 'https://em-content.zobj.net/thumbs/120/apple/354/tomato_1f345.png'
                });
            }

            // ë‹¤ìŒ ì„¸ì…˜ìœ¼ë¡œ ìë™ ì „í™˜
            setTimeout(() => {
                nextSession();
            }, 1000);
        }

        function nextSession() {
            if (sessionType === 'focus') {
                currentRound++;
                if (currentRound > 4) {
                    // ê¸´ íœ´ì‹
                    setSession('longBreak');
                    currentRound = 1;
                } else {
                    // ì§§ì€ íœ´ì‹
                    setSession('shortBreak');
                }
            } else {
                // ë‹¤ì‹œ ì§‘ì¤‘ ì‹œê°„
                setSession('focus');
            }
            updateRounds();
        }

        function setSession(type) {
            sessionType = type;

            if (type === 'focus') {
                totalTime = 50 * 60;
                sessionTitle.textContent = 'ì§‘ì¤‘ ì‹œê°„';
                sessionDesc.textContent = '50ë¶„ ë™ì•ˆ í•œ ê°€ì§€ ëª©í‘œì— ì§‘ì¤‘í•˜ì„¸ìš”.';
            } else if (type === 'shortBreak') {
                totalTime = 10 * 60;
                sessionTitle.textContent = 'ì§§ì€ íœ´ì‹';
                sessionDesc.textContent = '10ë¶„ ë™ì•ˆ íœ´ì‹ì„ ì·¨í•˜ì„¸ìš”.';
            } else if (type === 'longBreak') {
                totalTime = 20 * 60;
                sessionTitle.textContent = 'ê¸´ íœ´ì‹';
                sessionDesc.textContent = '20ë¶„ ë™ì•ˆ ì¶©ë¶„íˆ ì‰¬ì„¸ìš”.';
            }

            timeLeft = totalTime;
            updateDisplay();
        }

        function updateRounds() {
            for (let i = 1; i <= 4; i++) {
                const round = document.getElementById(`round${i}`);
                if (i < currentRound) {
                    round.className = 'w-2 h-2 rounded-full bg-primary';
                } else if (i === currentRound) {
                    round.className = 'w-2 h-2 rounded-full bg-primary';
                } else {
                    round.className = 'w-2 h-2 rounded-full bg-slate-300 dark:bg-slate-700';
                }
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        playPauseBtn.addEventListener('click', toggleTimer);
        resetBtn.addEventListener('click', reset);
        skipBtn.addEventListener('click', nextSession);

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                toggleTimer();
            } else if (e.code === 'KeyR') {
                reset();
            } else if (e.code === 'KeyN') {
                nextSession();
            }
        });

        // ì´ˆê¸°í™”
        updateDisplay();
    </script>
</body>

</html>